# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.linear <- svm(train.target ~ ., data=trainSet[,-c(1,6,7,11,12)], type="C-classification", kernel="radial")
train.res <- predict(svm.linear,data = trainSet[,-c(1,6,7,11,12)])
test.res <- predict(svm.linear, newdata = testSet[,-c(1,6,7,11,12)] )
train_total = train_total + mean(train.res == train.target) # 0.824
test_total = test_total + mean(test.res == test.target) # 0.818
train_total
test_total
summary(glm)
set.seed(666)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
glm = glm(train.target ~ ., data = trainSet[,-c(1,6,7,9,10)],family = "binomial")
summary(glm)
train_total = 0
test_total = 0
glm = glm(train.target ~ ., data = trainSet[,-c(1,6,7,9,10)],family = "binomial")
summary(glm)
train.glm = predict(glm, newdata = trainSet[,-c(1,6,7,9,10)])
plotROC(train.target, train.glm)
test.glm = predict(glm, newdata = testSet[,-c(1,6,7,9,10)])
plotROC(test.target, test.glm)
for (s in 600:700) {
set.seed(s)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
glm = glm(train.target ~ ., data = trainSet[,-c(1,7,9,10)],family = "binomial")
summary(glm)
# Significant features: limit_BAL, sex, education, marriage, pay_1,3,6, bill_amt1,2, pay_amt1,2,6
train.glm = predict(glm, newdata = trainSet[,-c(1,7,9,10)]) # using log
# plotROC(train.target, train.glm)
train.glm.bin = ifelse(predict(glm, newdata = trainSet[,-c(1,7,9,10)],type="response")>0.5,1,0)
train_total = train_total + mean(train.glm.bin == train.target)
test.glm = predict(glm, newdata = testSet[,-c(1,7,9,10)])
# plotROC(test.target, test.glm)
test.glm.bin = ifelse(predict(glm, newdata = testSet[,-c(1,7,9,10)],type="response")>0.5,1,0)
test_total = test_total + mean(test.glm.bin == test.target)
# 0.7885
}
train_total/100 # 0.7973
test_total/100 # 0.7969
barplot(table(card$SEX, card$TARGET), col=rainbow(2))
barplot(table(card$SEX, card$TARGET), col=rainbow(2),beside = TRUE)
table(card$SEX, card$TARGET)
barplot(table(card$SEX),col= rainbow(3))
barplot(table(card$SEX),col= rainbow(4))
barplot(table(card$SEX),col= c("lightblue", "red"))
barplot(table(card$SEX, card$TARGET), col=rainbow(2),beside = TRUE)
barplot(table(card$SEX, card$TARGET), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$EDUCATION, card$TARGET),col=rainbow(3))
barplot(table(card$TARGET,card$EDUCATION),col=rainbow(3))
barplot(table(card$TARGET,card$EDUCATION),col=rainbow(2))
barplot(table(card$TARGET),col=c("lightblue", "red"))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"))
barplot(table(card$TARGET, card$SEX), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("rightup"))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("rightup",col=c("lightblue", "red")))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("right",col=c("lightblue", "red")))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend(20,20,col=c("lightblue", "red")))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend(20,20,col=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$EDUCATION),col=rainbow(3))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend(20,20,col=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET, card$SEX), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend(20,20,col=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("rightup",col=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET, card$SEX), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("topright",col=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET, card$SEX), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("topright",fill=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$EDUCATION),col=rainbow(3))
barplot(table(card$TARGET, card$EDUCATION), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("topright",fill=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET, card$EDUCATION), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("topright",fill=c("lightblue", "red"),legend=c("0","1")))
barplot(table(card$TARGET, card$MARRIAGE), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$MARRIAGE),col=c("lightblue", "red"),legend("topright",fill=c("lightblue", "red"),legend=c("0","1")))
hist(card[,c('PAY_1', 'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6')], col="lightblue")
hist(card[card$PAY_AMT1 > 10000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 10000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 20000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 40000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 50000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 60000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 80000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 90000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 100000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 110000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card[card$PAY_AMT1 > 150000,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(card2$PAY_AMT_AVG)
card2$PAY_AMT_AVG_LOG = log(card2$PAY_AMT_AVG + 1 - min(card2$PAY_AMT_AVG))
hist(card2$PAY_AMT_AVG_LOG)
hist(log(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
hist(log(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')]))
hist(log(card[,c('PAY_AMT1']))
hist(log(card[,c('PAY_AMT1')]))
hist(log(card[,c('PAY_AMT1', 'PAY_AMT2')]))
hist(log(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')]))
describe(card[,c('PAY_AMT1', 'PAY_AMT2', 'PAY_AMT3', 'PAY_AMT4', 'PAY_AMT5', 'PAY_AMT6')])
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.linear <- svm(train.target ~ ., data=trainSet[,-c(1,6,7,11,12)], type="C-classification", kernel="radial")
train.res <- predict(svm.linear,data = trainSet[,-c(1,6,7,9,10)])
test.res <- predict(svm.linear, newdata = testSet[,-c(1,6,7,9,10)] )
set.seed(666)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.linear <- svm(train.target ~ ., data=trainSet[,-c(1,6,7,11,12)], type="C-classification", kernel="radial")
train.res <- predict(svm.linear,data = trainSet[,-c(1,6,7,9,10)])
test.res <- predict(svm.linear, newdata = testSet[,-c(1,6,7,9,10)] )
res <- cor(as.matrix(card[,-c(1,3,4,5,25)]))
# Use rcorr from Hmisc
# res <- rcorr(as.matrix(train.data[,1:7]))
corrplot(res, method="circle")
corrplot(res, method="number")
# Bill_AMT 1 - 6 high correlation
card2 = card
card2$PAY_MAX = apply(card[,c("PAY_1","PAY_2","PAY_3","PAY_4","PAY_5","PAY_6")],1,max)
card2$BILL_AMT_AVG = rowMeans(card[,13:18])
card2$PAY_AMT_AVG = rowMeans(card[,19:24])
card2[,7:24] = NULL
res = cor(as.matrix(card2[,-c(1,3,4,5,7)]))
corrplot(res, method="circle")
hist(card2$PAY_AMT_AVG)
card2$PAY_AMT_AVG_LOG = log(card2$PAY_AMT_AVG + 1 - min(card2$PAY_AMT_AVG))
hist(card2$PAY_AMT_AVG_LOG)
hist(card2$BILL_AMT_AVG)
card2$BILL_AMT_AVG_LOG = log(card2$BILL_AMT_AVG + 1 - min(card2$BILL_AMT_AVG))
hist(card2$BILL_AMT_AVG_LOG)
set.seed(666)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.radial <- svm(train.target ~ ., data=trainSet[,-c(1,6,7,11,12)], type="C-classification", kernel="radial")
train.res <- predict(svm.radial,data = trainSet[,-c(1,6,7,9,10)])
test.res <- predict(svm.radial, newdata = testSet[,-c(1,6,7,9,10)] )
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.radial <- svm(train.target ~ ., data=trainSet[,-c(1,6,7,11,12)], type="C-classification", kernel="radial")
train.res <- predict(svm.radial,data = trainSet[,-c(1,6,7,11,12)])
test.res <- predict(svm.radial, newdata = testSet[,-c(1,6,7,11,12)] )
train_total = train_total + mean(train.res == train.target) # 0.824
test_total = test_total + mean(test.res == test.target) # 0.818
train_total
test_total
knitr::opts_chunk$set(echo = TRUE)
library(Hmisc)
library(corrplot)
library(ggplot2)
library(Rfast)
# feature selection
library(leaps)
# SVM
library(e1071)
# CART tree
library(partykit)
library(rpart)
library(rpart.plot)
# C50 tree
library(C50)
# Bagging
library(caret)
library(ipred)
# Random forest
library(randomForest)
# Neural Networks
library(nnet)
library(NeuralNetTools)
library(naivebayes)
library(InformationValue)
card = read.csv("card.csv", header = TRUE, skip = 1)
# Rename pay_0 to pay_1, "default.payment.next.month" as 'target'
names(card)[names(card) == "PAY_0"] <- "PAY_1"
names(card)[names(card) == "default.payment.next.month"] <- "TARGET"
# Configure data types
# Categorical
card$SEX = as.factor(card$SEX)
card$MARRIAGE = as.factor(card$MARRIAGE)
card$TARGET = as.factor(card$TARGET)
# ordinal
card$EDUCATION = as.factor(card$EDUCATION)
describe(card[,c('LIMIT_BAL')]) # Broad range
hist(card$LIMIT_BAL,col="lightblue", main = "Histogram of limit of balance", xlab="limit of balance")
barplot(table(card$SEX,card$LIMIT_BAL))
# Categorical data
describe(card[,c('SEX', 'EDUCATION', 'MARRIAGE')])
barplot(table(card$SEX),col= c("lightblue", "red"))
barplot(table(card$TARGET, card$SEX), col=c("lightblue", "red"),beside = TRUE)
barplot(table(card$TARGET,card$EDUCATION),col=c("lightblue", "red"),legend("topright",fill=c("lightblue", "red"),legend=c("0","1")))
# Education: combine 0, 5, 6 -> 5
# Marriage: 0 -> 3
# PAY_i: -2, -1, 0 -> 0
# Check large pay_amt for outliers
card$EDUCATION[card$EDUCATION==0 | card$EDUCATION==6] = 5
card$MARRIAGE[card$MARRIAGE==0] = 3
card$EDUCATION = factor(card$EDUCATION)
card$MARRIAGE = factor(card$MARRIAGE)
card$PAY_1[card$PAY_1==-2 | card$PAY_1==-1] = 0
card$PAY_2[card$PAY_2==-2 | card$PAY_2==-1] = 0
card$PAY_3[card$PAY_3==-2 | card$PAY_3==-1] = 0
card$PAY_4[card$PAY_4==-2 | card$PAY_4==-1] = 0
card$PAY_5[card$PAY_5==-2 | card$PAY_5==-1] = 0
card$PAY_6[card$PAY_6==-2 | card$PAY_6==-1] = 0
describe(card[,c("EDUCATION","MARRIAGE")])
barplot(table(card$EDUCATION), col=rainbow(5))
barplot(table(card$MARRIAGE),col=rainbow(3))
describe(card[,c('PAY_1', 'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6')])
hist(card[,c('PAY_1', 'PAY_2', 'PAY_3', 'PAY_4', 'PAY_5', 'PAY_6')])
res <- cor(as.matrix(card[,-c(1,3,4,5,25)]))
# Use rcorr from Hmisc
# res <- rcorr(as.matrix(train.data[,1:7]))
corrplot(res, method="circle")
corrplot(res, method="number")
# Bill_AMT 1 - 6 high correlation
card2 = card
card2$PAY_MAX = apply(card[,c("PAY_1","PAY_2","PAY_3","PAY_4","PAY_5","PAY_6")],1,max)
card2$BILL_AMT_AVG = rowMeans(card[,13:18])
card2$PAY_AMT_AVG = rowMeans(card[,19:24])
card2[,13:24] = NULL
res = cor(as.matrix(card2[,-c(1,3,4,5,7)]))
res <- cor(as.matrix(card[,-c(1,3,4,5,25)]))
# Use rcorr from Hmisc
# res <- rcorr(as.matrix(train.data[,1:7]))
corrplot(res, method="circle")
corrplot(res, method="number")
# Bill_AMT 1 - 6 high correlation
card2 = card
card2$PAY_MAX = apply(card[,c("PAY_1","PAY_2","PAY_3","PAY_4","PAY_5","PAY_6")],1,max)
card2$BILL_AMT_AVG = rowMeans(card[,13:18])
card2$PAY_AMT_AVG = rowMeans(card[,19:24])
card2[,13:24] = NULL
res = cor(as.matrix(card2[,-c(1,3,4,5,13)]))
corrplot(res, method="circle")
hist(card2$PAY_AMT_AVG)
card2$PAY_AMT_AVG_LOG = log(card2$PAY_AMT_AVG + 1 - min(card2$PAY_AMT_AVG))
hist(card2$PAY_AMT_AVG_LOG)
hist(card2$BILL_AMT_AVG)
card2$BILL_AMT_AVG_LOG = log(card2$BILL_AMT_AVG + 1 - min(card2$BILL_AMT_AVG))
hist(card2$BILL_AMT_AVG_LOG)
set.seed(666)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.radial <- svm(train.target ~ ., data=trainSet[,-c(1,13,14)], type="C-classification", kernel="radial")
train.res <- predict(svm.radial,data = trainSet[,-c(1,13,14)])
test.res <- predict(svm.radial, newdata = testSet[,-c(1,13,14)] )
train_total = train_total + mean(train.res == train.target) # 0.824
test_total = test_total + mean(test.res == test.target) # 0.818
train_total
test_total
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
svm.radial <- svm(train.target ~ ., data=trainSet[,-c(1,13,14,15,16)], type="C-classification", kernel="radial")
train.res <- predict(svm.radial,data = trainSet[,-c(1,13,14,15,16)])
test.res <- predict(svm.radial, newdata = testSet[,-c(1,13,14,15,16)] )
train_total = train_total + mean(train.res == train.target) # 0.824
test_total = test_total + mean(test.res == test.target) # 0.818
train_total
test_total
library(e1071)
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="linear")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8229
# mean(test.res == test.target) # 0.8162
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="polynomial")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.8211
# mean(test.res == test.target) # 0.8144
#
# set.seed(666)
# svm.linear <- svm(train.target ~ ., data=trainSet[,2:11], type="C-classification", kernel="sigmoid")
#
# train.res <- predict(svm.linear,data = trainSet[,2:11])
# test.res <- predict(svm.linear, newdata = testSet[,2:11] )
# mean(train.res == train.target) # 0.7426
# mean(test.res == test.target) # 0.7431
train_total = 0
test_total = 0
for(s in 600:700) {
set.seed(s)
index = 1:nrow(card)
n = nrow(card)
testIndex = sample(index, trunc(n)/3)
testSet = card2[testIndex,]
trainSet = card2[-testIndex,]
train.target = trainSet$TARGET
test.target = testSet$TARGET
svm.radial <- svm(train.target ~ ., data=trainSet[,-c(1,13,14,15,16)], type="C-classification", kernel="radial")
train.res <- predict(svm.radial,data = trainSet[,-c(1,13,14,15,16)])
test.res <- predict(svm.radial, newdata = testSet[,-c(1,13,14,15,16)] )
train_total = train_total + mean(train.res == train.target) # 0.824
test_total = test_total + mean(test.res == test.target) # 0.818
}
